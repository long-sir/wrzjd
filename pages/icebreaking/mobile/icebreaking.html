<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta content="black" name="apple-mobile-web-app-status-bar-style" />
  <meta content="telephone=no" name="format-detection" />
  <meta content="email=no" name="format-detection" />
  <title>破冰赢手机</title>
  <link rel="stylesheet" type="text/css" href="./css/icebreakingStyle.css" />
  <script type="text/javascript">
  //初始化REM

  var setFontSize = function() {
    var width = document.documentElement.clientWidth;
    width = width > 1280 ? 1280 : width;
    var fontSize = width / 1280 * 100;
    document.getElementsByTagName("html")[0].style.fontSize = fontSize + "px";
  }
  setFontSize();
  window.onresize = setFontSize;
  </script>
</head>

<body>
  <div class="warp">
    <!-- 左边导航-->
    <div class="left Yahei">
      <div class="navBox">
        <a class="active"><span class="icon_hammer"></span>破冰赢手机</a>
      </div>
    </div>
    <!--左边end-->

    <div class="right">
      <div class="ice_01"></div>
      <div class="ice_02">
        <a class="btn_myPrize"></a>
        <div class="ice_container">
          <div class="hammer">
            <a class="btn_hammer" id="btn_hammer"></a>
            <p>破冰锤: 8888个</p>
          </div>
          <ul>
            <li class="item1">
              <img src="./images/icebreaking/ice_bg.png" class="ice_bg">
              <i class=""></i>
            </li>
            <li class="item2 ">
              <img src="./images/icebreaking/ice_bg.png" class="ice_bg">
              <i class=""></i>
            </li>
            <li class="item3">
              <img src="./images/icebreaking/ice_bg.png" class="ice_bg">
              <i class=""></i>
            </li>
            <li class="item4">
              <img src="./images/icebreaking/ice_bg.png" class="ice_bg">
              <i class=""></i>
            </li>
            <li class="item5">
              <img src="./images/icebreaking/ice_bg.png" class="ice_bg">
              <i class=""></i>
            </li>
            <li class="item6">
              <img src="./images/icebreaking/ice_bg.png" class="ice_bg">
              <i class=""></i>
            </li>
            <li class="item7">
              <img src="./images/icebreaking/ice_bg.png" class="ice_bg">
              <i class=""></i>
            </li>
            <li class="item8">
              <img src="./images/icebreaking/ice_bg.png" class="ice_bg">
              <i class=""></i>
            </li>
          </ul>
        </div>

        <div class="rule">
          <h3><img src="./images/icebreaking/icon_book.png"/>破冰秘籍</h3>
          <div class="rule_txt">
            <p>1.累计赢满30万送1个破冰锤，每局最多送1个</p>
            <p>2.每日最多可获得20个破冰锤</p>
            <p>3.捕鱼游戏、奖品斗地主、欢乐斗地主、决战、吹牛、万人拼十（抢庄场、双旦大战房、贵宾厅）、二人麻将、新三公、新十三水、血流成河参与此活动 </p>
          </div>
        </div>

        <div class="broadcast">
          <div class="rollCon1">
            <ul>
              <li>家旺一生998817:04抽中5元红包</li>
              <li>xzvbn153am14:22抽中58888积分</li>
              <li>席琳小屋13:26抽中58888积分</li>
              <li>skd00713:08抽中5元红包</li>
              <li>点上一支烟12:38抽中5元红包</li>
              <li>天天赢钱611:34抽中58888积分</li>
              <li>将醒10:53抽中58888积分</li>
              <li>胡子鲶10:39抽中58888积分</li>
              <li>足球在上10:25抽中5元红包</li>
              <li>太极赌神10:22抽中5元红包</li>
              <li>惊死狼10:22抽中58888积分</li>
              <li>昵称MCBC527109:05抽中5元红包</li>
              <li>爱拼才会赢9999908:44抽中58888积分</li>
              <li>唐啊文08:41抽中5元红包</li>
              <li>郑丽芹菜08:04抽中58888积分</li>
              <li>两栖和云07:10抽中58888积分</li>
              <li>人鸟鸟人07:01抽中58888积分</li>
              <li>雪的花06:46抽中58888积分</li>
              <li>芝宸兴安05:51抽中58888积分</li>
              <li>Henry1988121603:36抽中5元红包</li>
              <li>奇怪的家伙03:07抽中5元红包</li>
              <li>54623235502:09抽中5元红包</li>
              <li>又见烟雨蒙01:13抽中58888积分</li>
              <li>朱总57200:10抽中5元红包</li>
              <li>落尘23:18抽中5元红包</li>
              <li>三羊1开泰22:02抽中58888积分</li>
              <li>HHHHHHPPP22:01抽中5元红包</li>
              <li>赢个十亿21:39抽中58888积分</li>
              <li>红姬20:56抽中5元红包</li>
              <li>北山人19:48抽中5元红包</li>
              <li>奇怪的家伙19:25抽中58888积分</li>
              <li>1355987069818:53抽中5元红包</li>
              <li>急卖塞塞死18:17抽中58888积分</li>
              <li>排山倒海17:40抽中58888积分</li>
              <li>数语酷猪17:39抽中58888积分</li>
              <li>很相爱14:53抽中58888积分</li>
              <li>我是海14:31抽中58888积分</li>
              <li>将中胜13:55抽中58888积分</li>
              <li>失信13:41抽中58888积分</li>
              <li>貔貅的诱惑12:51抽中5元红包</li>
              <li>关心08:12抽中5元红包</li>
              <li>手足之情06:40抽中58888积分</li>
              <li>3815404:31抽中5元红包</li>
              <li>3815403:16抽中5元红包</li>
              <li>晋江赌圣02:46抽中5元红包</li>
              <li>200w700:02抽中5元红包</li>
              <li>金正恩23:56抽中5元红包</li>
              <li>红旗飘飘ooo22:08抽中5元红包</li>
              <li>特总兵20:49抽中58888积分</li>
              <li>h86944848620:48抽中5元红包</li>
              <li>家旺一生998817:04抽中5元红包</li>
              <li>xzvbn153am14:22抽中58888积分</li>
              <li>席琳小屋13:26抽中58888积分</li>
              <li>skd00713:08抽中5元红包</li>
              <li>点上一支烟12:38抽中5元红包</li>
              <li>天天赢钱611:34抽中58888积分</li>
              <li>将醒10:53抽中58888积分</li>
              <li>胡子鲶10:39抽中58888积分</li>
              <li>足球在上10:25抽中5元红包</li>
              <li>太极赌神10:22抽中5元红包</li>
              <li>惊死狼10:22抽中58888积分</li>
              <li>昵称MCBC527109:05抽中5元红包</li>
              <li>爱拼才会赢9999908:44抽中58888积分</li>
              <li>唐啊文08:41抽中5元红包</li>
              <li>郑丽芹菜08:04抽中58888积分</li>
              <li>两栖和云07:10抽中58888积分</li>
              <li>人鸟鸟人07:01抽中58888积分</li>
              <li>雪的花06:46抽中58888积分</li>
              <li>芝宸兴安05:51抽中58888积分</li>
              <li>Henry1988121603:36抽中5元红包</li>
              <li>奇怪的家伙03:07抽中5元红包</li>
              <li>54623235502:09抽中5元红包</li>
              <li>又见烟雨蒙01:13抽中58888积分</li>
              <li>朱总57200:10抽中5元红包</li>
              <li>落尘23:18抽中5元红包</li>
              <li>三羊1开泰22:02抽中58888积分</li>
              <li>HHHHHHPPP22:01抽中5元红包</li>
              <li>赢个十亿21:39抽中58888积分</li>
              <li>红姬20:56抽中5元红包</li>
              <li>北山人19:48抽中5元红包</li>
              <li>奇怪的家伙19:25抽中58888积分</li>
              <li>1355987069818:53抽中5元红包</li>
              <li>急卖塞塞死18:17抽中58888积分</li>
              <li>排山倒海17:40抽中58888积分</li>
              <li>数语酷猪17:39抽中58888积分</li>
              <li>很相爱14:53抽中58888积分</li>
              <li>我是海14:31抽中58888积分</li>
              <li>将中胜13:55抽中58888积分</li>
              <li>失信13:41抽中58888积分</li>
              <li>貔貅的诱惑12:51抽中5元红包</li>
              <li>关心08:12抽中5元红包</li>
              <li>手足之情06:40抽中58888积分</li>
              <li>3815404:31抽中5元红包</li>
              <li>3815403:16抽中5元红包</li>
              <li>晋江赌圣02:46抽中5元红包</li>
              <li>200w700:02抽中5元红包</li>
              <li>金正恩23:56抽中5元红包</li>
              <li>红旗飘飘ooo22:08抽中5元红包</li>
              <li>特总兵20:49抽中58888积分</li>
              <li>h86944848620:48抽中5元红包</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="bg" style="display: none;"></div>

    <!-- 中奖记录 -->
    <div class="diaBox box_jilu" id="recordBox" style="display: none; ">
      <div class="dia_header Yahei"> <a class="close pop_close"></a><img src="./images/icebreaking/zhong_jilu.png"> </div>
      <div class="dia_body" id="myPrizeContent">
        <table cellpadding="0" cellspacing="0" class="jaingpin_tb">
          <tr>
            <th width="15%">排名</th>
            <th width="15%">时间</th>
            <th width="50%">奖励</th>
            <th width="20%">状态</th>
          </tr>
          <tr>
            <td>2</td>
            <td>12.20 </td>
            <td class="red">500个雪人（价值5000元）</td>
            <td><a class=""></a>已发放</td>
          </tr>
          <tr class="tr">
            <td>2</td>
            <td>12.20 </td>
            <td class="red">500个雪人（价值5000元）</td>
            <td><a class="btn_lingquSmall"></a></td>
          </tr>
          <tr>
            <td>2</td>
            <td>12.20 </td>
            <td class="red">500个雪人（价值5000元）</td>
            <td><a class=""></a>已发放</td>
          </tr>
          <tr class="tr">
            <td>2</td>
            <td>12.20 </td>
            <td class="red">500个雪人（价值5000元）</td>
            <td><a class="btn_lingquSmall"></a></td>
          </tr>
          <tr>
            <td>2</td>
            <td>12.20 </td>
            <td class="red">500个雪人（价值5000元）</td>
            <td><a class=""></a>已发放</td>
          </tr>
        </table>
        <div class="pages">
          <a class="active">上一页</a> <span class="page_num">1</span> <span class="page_num1">2</span><a class="active">下一页</a>
        </div>
      </div>
    </div>

    <!--抱歉次数用完 -->
    <div class="diaBox sorryBox" style="display: none;">
      <div class="dia_header Yahei"><a class="close pop_close"></a></div>
      <div class="dia_body">
        <div class="tishi">
          <p class="rule">亲，您今天的抽奖次数已用完！</p>
        </div>
        <div class="btnAgain">
          <a></a>
        </div>
      </div>
    </div>

    <!--抱歉条件不足 -->
    <div class="diaBox sorryBox tiaoJianBox" style="display: none;">
      <div class="dia_header Yahei"><a class="close pop_close"></a></div>
      <div class="dia_body">
        <p class="rule tishi">亲，您还未达成抽奖条件噢！</p>
        <div class="btnAgain">
            <p>再赢199999积分就能抽奖啦！</p>
          <a></a>
        </div>
      </div>
    </div>

    <!--奖品物品-->
    <div class="diaBox prizeBox goodsBox" style="display: none;">
      <div class="diaBox_inner">
        <div class="dia_header Yahei"><a class="close pop_close"></a><img src="./images/icebreaking/gongxi_title.png"></div>
        <div class="dia_body">
          <p class="rule tishi">获得 <span>10个“圣诞铃铛”<br />（价值10元）</span></p>
          <div class="btnAgain">
            <p>可在万人拼十双旦大战中代替积分消耗</p>
            <a></a>
          </div>
        </div>
      </div>
    </div>

    <!--奖品红包-->
    <div class="diaBox prizeBox hongbaoBox" style="display: none;">
      <div class="diaBox_inner">
        <div class="dia_header Yahei"><a class="close pop_close"></a><img src="./images/icebreaking/gongxi_title.png"></div>
        <div class="dia_body">
          <p class="rule tishi">获得 <span>100元红包</span><br />红包已添加至您红包余额</p>
          <div class="btnAgain">
            <p>万人拼十双旦大战房每日壕送万元奖励</p>
            <a></a>
          </div>
        </div>
      </div>
    </div>

    <!--奖品积分-->
    <div class="diaBox prizeBox pointBox" style="display: none;">
      <div class="diaBox_inner">
        <div class="dia_header Yahei"><a class="close pop_close"></a><img src="./images/icebreaking/gongxi_title.png"></div>
        <div class="dia_body">
          <p class="rule tishi">获得 <span>100000积分</span><br />积分已添加至您账号上</p>
          <div class="btnAgain">
            <p>万人拼十双旦大战房每日壕送万元奖励</p>
            <a></a>
          </div>
        </div>
      </div>
    </div>

    <!-- 恭喜对话框 -->
    <div class="diaBox gongxi" style="display: none">
      <div class="diaBox_inner">
        <div class="dia_header Yahei"><a class="close pop_close"></a><img src="images/icebreaking/gongxi_title.png"></div>
        <div class="dia_body">
          <p class="rule tishi">获得 <span>价值100元的 </span></p>
          <div class="card_socks" id="card_gift">
            <div class="icon_bg"></div>
            <p class="number">x100</p>
            <p class="gift_name">圣诞袜</p>
          </div>
          <div class="btnAgain">
            <p>可在双旦大作战游戏中代替积分消耗</p>
            <a class="btn_liangjiang"></a>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="./js/jquery-1.8.3.min.js"></script>
  <script src="./js/rollOdao.js"></script>
  <script>
  var ratio = getRatio()

  $(function(){
    $(".rollCon1").rollOdao()
    disorder()
    scale()
    $('#btn_hammer').click(startShuffle)
  })

  function scale(){
    var widthMax = $('.ice_container li>i').width() * 1,
      widthMin = $('.ice_container li>i').width() * 0.9,
      heightMax = $('.ice_container li>i').height() * 1,
      heightMin = $('.ice_container li>i').height() * 0.9
    window.setInterval(function(){
      $('.smash').animate({
        width: widthMin,
        height: heightMin
      }, 500).animate({
        width: widthMax,
        height: heightMax
      }, 500)
    },1000)
  }

  function getRatio(){
    var width = document.documentElement.clientWidth;
    width = width > 1280 ? 1280 : width;
    return width / 1280 * 100;
  }

  function startShuffle(){
    $('#btn_hammer').unbind()
    $('.hammer').hide()
    //将牌集合到一处
    window.setTimeout(function() {
      sort()
    }, 500)

    // 洗牌次数
    window.setTimeout(function() {
      for (var j = 0; j < 10; j++) {
        $('.icon_prizeOn').removeClass('icon_prizeOn')
        $('.ice_container .ice_bg').removeClass('ice_bgOn').attr('src','./images/icebreaking/ice_bg.png')
        if (j === 3) $('.ice_container .item_inner').remove()
        shuffle()
      }
      sort()
    }, 1000)

    //发牌
    window.setTimeout(function() {
      poker()
      window.setTimeout(function(){
        $('.ice_container li').click(flip)
        $('.ice_container i').addClass('smash')
      }, 500)
      window.setTimeout(function(){
        $('.hammer').show()
      }, 500)
    }, 1500)
  }

  //翻牌
  function flip(){
    var url = './images/icebreaking/ice_breaking.gif?version=' + Math.floor(Math.random() * 100000000),
      self = this
    $('.ice_container li').unbind()
    $('.ice_container .smash').removeClass('smash')
    $(this).append(getGif(url, 'ice_bg gif', function(){
      showPrize.call(this)
    }))

    function showPrize(){
      $(self).find('.ice_bg').not('.gif').remove()
      this.onload = null
      window.setTimeout(function(){
        var prizeName = ['coin1', 'hongbao', 'bag1', 'iPad', 'coin2', 'card', 'bag2', 'iPhone']
        var htmlObject = getHTML()
        //key 是从后台传过来的
        var key = "iPad"
        var $html = $(htmlObject[key]).find('.icon_prize').addClass('icon_prizeOn').end()
        var $cardList = $(self).siblings()

        prizeName.splice(prizeName.indexOf(key), 1)
        var $icebgOn = $('<img/>').attr('src', './images/icebreaking/ice_bgOn.png').addClass('ice_bg ice_bgOn')
        $(self).find('.gif').remove().end().append($icebgOn).append($html)

        for (var i = 0; i < $cardList.length; i++){
          var object = spliceArray(prizeName)
          prizeName = object.array
          var html = htmlObject[object.item];
          (function(j,nhtml){
            window.setTimeout(function(){
              $($cardList[j]).append(nhtml)
              if(j === 6){
                $('#btn_hammer').click(startShuffle)
              }
            }, 500)
          })(i,html)
        }
      }, 800)
    }
  }

  //发牌
  function poker() {
    var position = {
        item1: { "top": 0, "left": 0 },
        item2: { top: 1.45 * ratio, left: 0 },
        item3: { top: 2.91 * ratio, left: 0 },
        item4: { top: 2.91 * ratio, left: 1.64 * ratio },
        item5: { top: 2.91 * ratio, left: 3.27 * ratio },
        item6: { top: 1.45 * ratio, left: 3.27 * ratio },
        item7: { top: 0, left: 3.27 * ratio },
        item8: { top: 0, left: 1.64 * ratio }
      },
      timeout = 100
    for (var i = 1; i < 9; i++) {
      var className = 'item' + i
      $('.' + className).animate({
        top: position[className].top,
        left: position[className].left,
        'z-index': 1
      }, timeout)
      timeout += 10
    }
  }

  //洗牌
  function shuffle() {
    var $cardList = $('.ice_container li'),
      zIndexList = [1, 2, 3, 4, 5, 6, 7, 8 ]
    for (var j = 0; j < $cardList.length; j++) {
      var zIndex = spliceArray(zIndexList).index
      var left = window.Math.random() < 0.5 ? 166 + window.Math.floor(50 * window.Math.random()) : 166 - window.Math.floor(50 * window.Math.random())
      var top = window.Math.random() < 0.5 ? 166 + window.Math.floor(50 * window.Math.random()) : 166 - window.Math.floor(50 * window.Math.random())
      var card = $cardList[j]
      $(card).animate({
        left: left / 100 * ratio,
        top: top / 100 * ratio,
        'z-index': zIndex
      }, 30)
    }
  }

  function spliceArray(array){
    var removeIndex = window.Math.floor(array.length * window.Math.random())
    var removeItem = array[removeIndex]
    array.splice(removeIndex, 1)
    return {array: array, index: removeIndex, item: removeItem}
  }

  // 洗牌结束后将牌集中一处
  function sort() {
    var $cardList = $('.ice_container li'),
      timeout = 100,
      top = 1.75 * ratio,
      left = 1.75 * ratio

    for (var i = 0; i < $cardList.length; i++) {
      $($cardList[i]).animate({
        top: top,
        left: left,
        opacity: 1
      }, timeout, 'swing')
      timeout += 50
      top -= 1
      left -= 1
    }
  }

  function getGif(url, className, callback){
    var image = new Image()
    image.setAttribute('class', className)
    image.onload = callback
    image.src = url
    return image
  }

  function getHTML(){
    return {
      coin1: '<div class="item_inner coin1"> <span class="icon_prize"></span> <div class="txt"> <p>1000~10万</p> <p>积分</p> </div> </div> ',
      hongbao: '<div class="item_inner hongbao"> <span class="icon_prize"></span> <div class="txt"> <p>1~100元</p> <p>红包</p> </div> </div> ',
      bag1:'<div class="item_inner bag1"> <span class="icon_prize"></span> <div class="txt"> <p>x 1</p> <p>游戏福袋</p> </div> </div> ',
      iPad: '<div class="item_inner iPad"> <span class="icon_prize"></span> <div class="txt"> <p>iPad mini4</p> <p>128G</p> </div> </div> ',
      coin2: '<div class="item_inner coin2"> <span class="icon_prize"></span> <div class="txt"> <p>1万~100万</p> <p>积分</p> </div> </div> ',
      card: '<div class="item_inner card"> <span class="icon_prize"></span> <div class="txt"> <p>500元京东卡</p> </div> </div> ',
      bag2: '<div class="item_inner bag2"> <span class="icon_prize"></span> <div class="txt"> <p>x 1</p> <p>游戏福袋</p> </div> </div> ',
      iPhone: '<div class="item_inner iPhone"> <span class="icon_prize"></span> <div class="txt"> <p>iPhone X</p> <p>256G</p> </div> </div> '
    }
  }

  //打乱顺序
  function disorder(){
    var prizeName = ['coin1', 'hongbao', 'bag1', 'iPad', 'coin2', 'card', 'bag2', 'iPhone'],
      $cardList = $('.ice_container li'),
      htmlObject = getHTML()

    $('.item_inner').remove()
    for (var i = 0; i < $cardList.length; i++){
      var object = spliceArray(prizeName)
      prizeName = object.array
      var html = htmlObject[object.item]
      $($cardList[i]).append(html)
    }
  }
  </script>
</body>

</html>
